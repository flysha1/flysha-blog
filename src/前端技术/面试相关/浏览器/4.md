---
date: 2018-01-01
category:
  - 前端技术
tag:
  - 浏览器
  - 面经
---

# 4. 浏览器渲染

## 1. 常见浏览器所用内核

- IE浏览器内核，```Trident``` 内核，也是俗称的IE内核

- Chrome 浏览器内核，以前是 ```Webkit``` 内核，现在是 ```Blink``` 内核

- Firefox 浏览器内核：```Gecko``` 内核，俗称 Firefox 内核

- Safari 浏览器内核：```Webkit``` 内核

- 360浏览器、猎豹浏览器内核：```IE + Chrome``` 双内核

## 2. 浏览器的渲染过程

1. 解析文档，生成 ``DOM`` 树

2. 解析 ```CSS``` ，根据 ```CSS``` 规则生成 ```CSSOM``` 规则树

3. 在 ```CSSOM``` 树和 ```DOM``` 树生成完后，合并 ```DOM``` 、 ```CSSOM``` 树构建渲染树

4. 渲染树构建完成后，开始计算元素大小和位置【回流发生在这个阶段】

5. 根据计算好的位置信息将内容渲染到屏幕上【重绘发生在这个阶段】

## 3. 浏览器渲染优化

- 优化 ```javaScript``` ，```JavaScript``` 会阻塞 ```HTML``` 的解析，改变 ```JavaScrip``` 加载方式。

    - 将 ```JavaScript``` 放到 ```body``` 最后面

    - 尽量使用异步加载JS资源，这样不会阻塞 ```DOM``` 解析，如 ```defer``` 、 ```async```

- 优化 ```CSS``` 加载

    - ```CSS``` 样式少，使用内嵌样式

    - 导入外部样式使用 ```link``` ，而不是 ```@import``` ，因为它会阻塞渲染。

- 减少回流重绘

    - 避免频繁操作样式

    - 避免频繁操作 ```DOM```

    - 复杂动画使用定位脱离文当流
    
    - 使用 ```transform``` 替代动画

## 4. 回流与重绘

**回流**：当DOM变化影响了元素，比如元素的尺寸、布局、显示隐藏等改变了，需要重写构建。每个页面至少需要一次回流，就是在页面第一次加载的时候，这个时候一定会发生回流。

**重绘**：当一个元素的外观发生变化，但是没有改变布局，重新渲染元素的外观。比如 ```background-color``` 、 ```color```

**如何避免回流重绘**：

- 避免使用 ```table``` 布局

- 尽可能在 ```DOM``` 树的最末端改变 ```class```

- 不要频繁的操作元素的样式

- 避免设置多层内联样式

- 开启 ```GPU``` 加速

- 使用 ```absolute``` 或者 ```fixed``` ，脱离标准文档流

**注意**：回流必将引起重绘，而重绘不一定会引起回流
